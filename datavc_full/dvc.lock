schema: '2.0'
stages:
  create_dirs:
    cmd: mkdir -p -v data/ output/ model_output/
  install:
    cmd: "pip install --upgrade pip\npip install -r requirements.txt\n"
    deps:
    - path: requirements.txt
      hash: md5
      md5: 6316fee017380d38c7371af00884f769
      size: 248
  import_data:
    cmd: ./import_data.sh
  clean_data:
    cmd: "python3 cleandata.py load_data --file_path data/original_data/insurance.csv\n
      python3 cleandata.py summary --file_path data/original_data/insurance.csv\n
      python3 cleandata.py check_missing --file_path data/original_data/insurance.csv\n
      python3 cleandata.py check_duplicate --file_path data/original_data/insurance.csv\n
      python3 cleandata.py encode_data --file_path data/original_data/insurance.csv
      --version 000\n"
    deps:
    - path: cleandata.py
      hash: md5
      md5: fd9adffa3c156bd01b9bdfc2a091cc62
      size: 6223
    - path: data/original_data/insurance.csv
      hash: md5
      md5: d5364d06246fb4bfa4cc7d1ee89ebd0d
      size: 55628
    - path: import_data.sh
      hash: md5
      md5: 8b44b1d0aa1231750c73897e2f6156c4
      size: 1394
    outs:
    - path: data/transform/insurance_000.parquet
      hash: md5
      md5: d064f0730660d1e626b7318b5a3373b6
      size: 18857
  eda:
    cmd: python3 eda.py --input data/transform/insurance_000.parquet --output output/eda_combined_plots.png
    deps:
    - path: cleandata.py
      hash: md5
      md5: fd9adffa3c156bd01b9bdfc2a091cc62
      size: 6223
    - path: eda.py
      hash: md5
      md5: c5107f8ca7babe1d53bf849a9e6dddec
      size: 6325
    outs:
    - path: output/eda_combined_plots.png
      hash: md5
      md5: 2357a0f5a1a7e8572429b5eeb7e1bd06
      size: 378569
  split_data:
    cmd: python3 split_data.py --data data/transform/insurance_000.parquet
    deps:
    - path: data/transform/insurance_000.parquet
      hash: md5
      md5: d064f0730660d1e626b7318b5a3373b6
      size: 18857
    - path: eda.py
      hash: md5
      md5: c5107f8ca7babe1d53bf849a9e6dddec
      size: 6325
    - path: split_data.py
      hash: md5
      md5: 7fd93719183bab98b9f49ea24141d764
      size: 4230
    params:
      params.yaml:
        split_data.strategy: train_test_split
        split_data.test_size: 0.2
  evaluate_model:
    cmd: python3 evaluate.py
    deps:
    - path: data/transform/insurance_000.parquet
      hash: md5
      md5: d064f0730660d1e626b7318b5a3373b6
      size: 18857
    - path: evaluate.py
      hash: md5
      md5: 0bf609acfd3419ab254c8cbe2e48903d
      size: 5314
    - path: split_data.py
      hash: md5
      md5: 7fd93719183bab98b9f49ea24141d764
      size: 4230
    params:
      params.yaml:
        evaluate_model.criterion: squared_error
        evaluate_model.degree: 3
        evaluate_model.max_leaf_nodes: 4
        evaluate_model.min_samples_leaf: 20
    outs:
    - path: metrics.json
      hash: md5
      md5: e4a7abcc5a5c3ad02d4e76c254e19c63
      size: 219
    - path: model_output/linear_model_scaled.joblib
      hash: md5
      md5: 7574909f2f0f3b0b2592e3014897a35a
      size: 655
    - path: model_output/tree_model.joblib
      hash: md5
      md5: ee2cc7d5f5124ff764b1763d5abfed7b
      size: 2049
    - path: output/decision_tree.png
      hash: md5
      md5: a616b5763f15d7921e97e064a88ca20e
      size: 85099
  send_message:
    cmd: python3 send_sms.py $USERNAME $PHONE_NUMBER "Model evaluation is complete."
